<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<link rel="stylesheet" type="text/css" href="/emds_sso/js/datatables.min.css">
<link href="/emds_sso/js/fontawesome-free-5.12.0-web/css/all.css" rel="stylesheet"> <!--load all styles -->
<script src="/emds_sso/js/jquery-1.9.1.min.js"></script>
<script src="/emds_sso/js/datatables.min.js"></script>

<title>Subscriptions</title>
</head>
<body>
<!-- KIM: ADD THIS PARAMETER TO REMOVE THE SHOW ENTRIES DROPDOWN -->
<style>
.dataTables_wrapper .dataTables_filter {
float: right;
text-align: right;
visibility: hidden;
}
</style>
<h1>Subscriptions</h1>
<table id="subscription-list" class="display" style="width:100%">

        <thead>
              <tr>
            	<th>Action</th>
                <th>UIC</th>
                <th>Unit Name</th>
                <th>Email Me</th>
                <th>C1</th>
                <th>C2</th>
                <th>C3</th>
                <th>C4</th>
                <th>C5</th>
                <th>Any Change C</th>
                <th>P1</th>
                <th>P2</th>
                <th>P3</th>
                <th>P4</th>
                <th>P5</th>
                <th>P6</th>
                <th>Any Change P</th>
                <th>S1</th>
                <th>S2</th>
                <th>S3</th>
                <th>S4</th>
                <th>S5</th>
                <th>S6</th>
                <th>Any Change S</th>
                <th>R1</th>
                <th>R2</th>
                <th>R3</th>
                <th>R4</th>
                <th>R5</th>
                <th>R6</th>
                <th>Any Change R</th>
                <th>T1</th>
                <th>T2</th>
                <th>T3</th>
                <th>T4</th>
                <th>T5</th>
                <th>T6</th>
                <th>Any Change T</th> 
                <th>A1</th>
                <th>A2</th>
                <th>A3</th>
                <th>A4</th>
                <th>Any Change A</th>      
                <th>AMM1</th>
                <th>AMM2</th>
                <th>AMM3</th>
                <th>AMM4</th>
                <th>AMM Watch</th>  
                <th>AME1</th>
                <th>AME2</th>
                <th>AME3</th>
                <th>AME4</th>
                <th>AME Watch</th>   
                <th>Any Change Asgd Msn</th>
                <th>Asgd Msn Y/Q/N Y</th>
                <th>Asgd Msn Y/Q/N Q</th>
                <th>Asgd Msn Y/Q/N N</th>
                <th>SR Module Prepare</th>   
				<th>SR Module Ready</th>  
				<th>SR Module Mission</th>
                <th>SR Module Other/Unknown</th>
                <th>Any Change SR Module</th>    
                <th>Any Change Current Plan/Mission</th>
                <th>Overall Y/Q/N Y</th>
                <th>Overall Y/Q/N Q</th>
                <th>Overall Y/Q/N N</th>
                <th>Any Change Overall Y/Q/N</th>
                <th>Any Change Present Location</th>                                                                                         
                <th>Any Change Unit Reported</th>                                                                                         
                <th>Asgd % DIR</th>
                <th>Asgd %</th>
                <th>Depl % DIR</th>
                <th>Depl %</th>
                <th>SG % DIR</th>
                <th>SG %</th>
                <th>Asgd MOS Skills Match % DIR</th>
                <th>Asgd MOS Skills Match %</th>
                <th>AC</th>
                <th>ARNG</th>
                <th>USAR</th>
                <th>APS</th>
                <th>Report Type Regular</th>
                <th>Report Type Deployed</th>
                <th>Report Type Validation</th>
                <th>Report Type DUIC</th>
                <th>Report Type DRU</th>                
                <th>Any Change Report Type</th>                 
            </tr>

        </thead>

        <tfoot>
            <tr>
            	<th>Action</th>
                <th>UIC</th>
                <th>Unit Name</th>
                <th>Email Me</th>
                <th>C1</th>
                <th>C2</th>
                <th>C3</th>
                <th>C4</th>
                <th>C5</th>
                <th>Any Change C</th>
                <th>P1</th>
                <th>P2</th>
                <th>P3</th>
                <th>P4</th>
                <th>P5</th>
                <th>P6</th>
                <th>Any Change P</th>
                <th>S1</th>
                <th>S2</th>
                <th>S3</th>
                <th>S4</th>
                <th>S5</th>
                <th>S6</th>
                <th>Any Change S</th>
                <th>R1</th>
                <th>R2</th>
                <th>R3</th>
                <th>R4</th>
                <th>R5</th>
                <th>R6</th>
                <th>Any Change R</th>
                <th>T1</th>
                <th>T2</th>
                <th>T3</th>
                <th>T4</th>
                <th>T5</th>
                <th>T6</th>
                <th>Any Change T</th> 
                <th>A1</th>
                <th>A2</th>
                <th>A3</th>
                <th>A4</th>
                <th>Any Change A</th>      
                <th>AMM1</th>
                <th>AMM2</th>
                <th>AMM3</th>
                <th>AMM4</th>
                <th>AMM Watch</th>  
                <th>AME1</th>
                <th>AME2</th>
                <th>AME3</th>
                <th>AME4</th>
                <th>AME Watch</th>   
                <th>Any Change Asgd Msn</th>
                <th>Asgd Msn Y/Q/N Y</th>
                <th>Asgd Msn Y/Q/N Q</th>
                <th>Asgd Msn Y/Q/N N</th>
                <th>SR Module Prepare</th>   
				<th>SR Module Ready</th>  
				<th>SR Module Mission</th>
                <th>SR Module Other/Unknown</th>
                <th>Any Change SR Module</th>    
                <th>Any Change Current Plan/Mission</th>
                <th>Overall Y/Q/N Y</th>
                <th>Overall Y/Q/N Q</th>
                <th>Overall Y/Q/N N</th>
                <th>Any Change Overall Y/Q/N</th>
                <th>Any Change Present Location</th>                                                                                         
                <th>Any Change Unit Reported</th>                                                                                         
                <th>Asgd % DIR</th>
                <th>Asgd %</th>
                <th>Depl % DIR</th>
                <th>Depl %</th>
                <th>SG % DIR</th>
                <th>SG %</th>
                <th>Asgd MOS Skills Match % DIR</th>
                <th>Asgd MOS Skills Match %</th>
                <th>AC</th>
                <th>ARNG</th>
                <th>USAR</th>
                <th>APS</th>
                <th>Report Type Regular</th>
                <th>Report Type Deployed</th>
                <th>Report Type Validation</th>
                <th>Report Type DUIC</th>
                <th>Report Type DRU</th>                
                <th>Any Change Report Type</th>      
            </tr>
        </tfoot>
    </table>
<script>

var table = null;
$(document).ready(function() {
	
    // Setup - add a text input to each footer cell
    $('#subscription-list thead th').each( function () {
        var title = $(this).text();
        if(title !== 'Action'){
        	$(this).html( '<div><div>' + title + '</div><input type="text" placeholder="Search '+title+'" /></div>' );
        }
        
    } );	
	
	
    // Initialize the datatable
    table = $('#subscription-list').DataTable( {

    	/* CHANGE THE API FOR PRODUCTION */ 	
        "ajax": "/emds_sso/mockapi/subscriptions.json",
        /* KIM: ADD THIS PARAMETER TO REMOVE THE SHOW ENTRIES DROPDOWN */
        "bLengthChange": false,
        "columns": [
        	{ "data": "id",
        	  "render": function ( data, type, row, meta ) {
        		  console.log("render delete...data, type, row, meta",data, type, row, meta);
			      return '<a  href="javascript:void(0);" onclick="deleteSubscription(' + data + ');"><i class="fas fa-trash-alt"></i></a>';
			    }},
        	{"data":"uic"},
        	{"data":"unitName"},
        	{"data":"emailMe"},
        	{"data":"c1"},
        	{"data":"c2"},
        	{"data":"c3"},
        	{"data":"c4"},
        	{"data":"c5"},
        	{"data":"anyChangeC"},
        	{"data":"p1"},
        	{"data":"p2"},
        	{"data":"p3"},
        	{"data":"p4"},
        	{"data":"p5"},
        	{"data":"p6"},
        	{"data":"anyChangeP"},
        	{"data":"s1"},
        	{"data":"s2"},
        	{"data":"s3"},
        	{"data":"s4"},
        	{"data":"s5"},
        	{"data":"s6"},
        	{"data":"anyChangeS"},
        	{"data":"r1"},
        	{"data":"r2"},
        	{"data":"r3"},
        	{"data":"r4"},
        	{"data":"r5"},
        	{"data":"r6"},
        	{"data":"anyChangeR"},
        	{"data":"t1"},
        	{"data":"t2"},
        	{"data":"t3"},
        	{"data":"t4"},
        	{"data":"t5"},
        	{"data":"t6"},
        	{"data":"anyChangeT"},
        	{"data":"a1"},
        	{"data":"a2"},
        	{"data":"a3"},
        	{"data":"a4"},
        	{"data":"anyChangeA"},
        	{"data":"amm1"},
        	{"data":"amm2"},
        	{"data":"amm3"},
        	{"data":"amm4"},
        	{"data":"ammWatch"},
        	{"data":"ame1"},
        	{"data":"ame2"},
        	{"data":"ame3"},
        	{"data":"ame4"},
        	{"data":"ameWatch"},
        	{"data":"anyChangeAsgdMsn"},
        	{"data":"asgdMsnY"},
        	{"data":"asgdMsnQ"},
        	{"data":"asgdMsnN"},
        	{"data":"srPrepare"},
        	{"data":"srReady"},
        	{"data":"srMission"},
        	{"data":"srOther"},
        	{"data":"anyChangeSr"},
        	{"data":"anyChangeCurrentPlan"},
        	{"data":"overallY"},
        	{"data":"overallQ"},
        	{"data":"overallN"},
        	{"data":"anyChangeOverAll"},
        	{"data":"anyChangePresentLocation"},
        	{"data":"anyChangeUnitReported"},
        	{"data":"asgdPerDir"},
        	{"data":"asgdPer"},
        	{"data":"deplPerDir"},
        	{"data":"deplPer"},
        	{"data":"sgPerDir"},
        	{"data":"sgPer"},
        	{"data":"asgdMosSkilsPerDir"},
        	{"data":"asgdMosSkilsPer"},
        	{"data":"ac"},
        	{"data":"arng"},
        	{"data":"usar"},
        	{"data":"aps"},
        	{"data":"reportTypeReg"},
        	{"data":"reportTypeDeployed"},
        	{"data":"reportTypeValidation"},
        	{"data":"reportTypeDUIC"},
        	{"data":"reportTypeDRU"},
        	{"data":"reportTypeChanged"}
          ]
    } );
    

 
    // DataTable
    //var table = $('#subscription-list').DataTable();
 
    // Apply the search
    table.columns().every( function () {
        var that = this;
 
        $( 'input', this.header() ).on( 'keyup change clear', function () {
            if ( that.search() !== this.value ) {
                that
                    .search( this.value )
                    .draw();
            }
        } );
    } );   
    

});

/**
 * Function to refresh the list
 */
const refreshSubscriptionList = (data, textStatus) => { 
	table.ajax.reload();
}

/**
 * Function to remove a row
 */
const deleteSubscription = (id) => {
	console.log("delete subscription ==>", id);
	/* CHANGE THE API FOR PRODUCTION */ 
    const url = '/emds_sso/mockapi/subscriptions.json';
    const param = {
        remove: id
    };

    $.ajax({
        url: url,
        method: "GET", //send it through get method
        data: param,
        success: refreshSubscriptionList,
        error: (jqXHR, textStatus, errorThrown) => {
        	alert("Error " + textStatus + "\n" + errorThrown);
        }
    });	
	
};  
</script>
</body>
</html>